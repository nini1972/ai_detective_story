==================================================
AI-POWERED VISUAL TESTIMONY SYSTEM TESTER
==================================================

🔍 Testing Health Endpoint...
✅ Passed - Status: 200
Health status: {'status': 'healthy', 'ai_services': 'dual-ai-active'}

🔍 Testing Generate Case...
✅ Passed - Status: 200
Generated case ID: b430cfc4-2cbb-4346-9897-57688589f7c2
Session ID: 2f8b49d2-6076-4f5b-831d-c84f3abde474
Case title: Murder on Starling Isle
Setting: Starling Isle, a secluded private island resort off the coast of Maine, modern day (late autumn storm season)
Victim: Eliza Harrow
Number of characters: 5
Number of evidence items: 7
❌ No crime scene image generated
First character: Julian West

Waiting for case to be fully processed...

🔍 Testing Get Case...
✅ Passed - Status: 200
Retrieved case title: Murder on Starling Isle
❌ No crime scene image present

==================================================
TESTING VISUAL TESTIMONY SYSTEM
==================================================

🔍 Testing Get Initial Case State...
✅ Passed - Status: 200
Initial visual scenes count: 0

🔍 Testing visual question 1: 'What exactly did you see that night?'

🔍 Testing Question Character...
✅ Passed - Status: 200
Character name: Julian West
Response: (Julian West smooths a cufflink, his voice measured, eyes cool but red-rimmed—the strain of the evening apparent.)

What did I see? Well—the storm was howling, you remember, and I'd retreated to my suite to join a late video call. I’d hoped to avoid the evening’s drama. Wi-Fi gave out, predictably, so I busied myself with paperwork. Around half past nine, I nipped down the hall hoping to find Roger—he’s usually lurking by the billiards room, but I only spotted Tessa emerging from Eliza’s study. She seemed flustered, muttered something about mislaid papers.

Later, when the shouting started—Agnes, I think, calling for help—I hurried to the library with the rest. 

I didn’t see or hear anything specifically untoward before that—save perhaps a slammed door, but in these old places that’s nothing unusual. If you’re implying I had reason to harm Eliza, you’re mistaken—family disagreements aside.

🔍 Testing visual question 2: 'Describe what happened in detail'

🔍 Testing Question Character...
✅ Passed - Status: 200
Character name: Julian West
Response: (Leans back in the library chair, smoothing a silver cufflink, eyes troubled but steady.)

It’s all a bit of a blur—I still can’t quite process it. I was in my suite most of the evening on a scheduled call with my European associates. There was a deal I simply had to oversee, given the time zone difference. Unfortunately, the storm made a mess of the Wi-Fi. The connection dropped just after nine-thirty.

Afterward, I remained in the room, catching up on messages, or—trying to. Around ten, I went downstairs to the conservatory for a drink. I passed Roger in the hall; he looked out of sorts, muttering about the lights flickering. I didn’t see Eliza at all after dinner.

You know, there was quite a lot of tension tonight. Marina and Tessa both had words with Eliza earlier. Even Agnes, who’s usually unflappable, seemed upset. Everyone’s nerves were frayed—perhaps for good reason, as it turns out.

🎬 VISUAL SCENE GENERATED!
  - Title: Scene: Testimony
  - Description: Julian West testified: (Leans back in the library chair, smoothing a silver cufflink, eyes troubled ...
  - Image URL: https://v3.fal.media/files/rabbit/GF1vqLX-PAygUgkglcHUf.png
  - Generated from: testimony
  - Character involved: Julian West
✅ Visual scene generated from question 2!

🔍 Testing visual question 3: 'Tell me about the scene when you found the body'

🔍 Testing Question Character...
✅ Passed - Status: 200
Character name: Julian West
Response: *Julian smooths a cufflink, voice low but oddly steady.* 

Of course, detective. I—well, I didn’t actually *find* Eliza. It was Tessa, the housekeeper. She came running down the hall, pale as milk, shouting for help. I was in my suite, as I told you, on a call, but the storm took out the Wi-Fi, so I was just collecting myself, I suppose.

When I reached the library, Roger was already inside—looked shocked, muttering something about the safe. The books were scattered, glass on the floor... Eliza slumped at her desk. Honestly, it’s all somewhat hazy. I remember Marina standing rooted in the doorway, almost catatonic. And—Agnes, the gardener, peered in but disappeared before anyone could ask questions. 

I assure you, detective, I scarcely touched anything—didn’t want to disturb the scene. It was... grotesque, truly.

🔍 Testing visual question 4: 'What did the confrontation look like?'

🔍 Testing Question Character...
✅ Passed - Status: 200
Character name: Julian West
Response: (Adjusts cufflinks, voice low and steady.) Detective, you'd have to be more specific—which confrontation? If you mean Eliza and me, our disagreements were dreadfully predictable: her rapping the desk with her knuckle, that sharp tone poised to pierce. Last evening, before dinner, we had words in the study about the manor—her plans to sell, my objections. She was stubborn as ever, but it never escalated beyond raised voices.

But if you mean *the* confrontation in the library, I'm afraid I didn't witness it. I was upstairs in my suite for that critical hour, wrestling with a spotty video call and cursing the gale for dropping our connection. I can't speak to who else might have confronted her, but I did see Roger lingering in the hallway near the library around half past nine—looked rather agitated, frankly. And Tessa, the housekeeper, seemed to be flitting nervously about as well.

🔍 Testing visual question 5: 'Can you describe what you witnessed?'

🔍 Testing Question Character...
✅ Passed - Status: 200
Character name: Julian West
Response: (Adjusts cufflinks, a faint crease forming between his brows.)

Of course, Detective. I don’t know how much I can offer, but I’ll try. I was in my suite during that storm—the wind was howling like a banshee. I’d arranged a video call with colleagues in London, a rather tedious bit of business. The Wi-Fi cut out halfway through, so I tried to reconnect—no luck. Frustrated, I opened a window for air and, from the corridor, I heard voices—could’ve been Roger or Tessa, perhaps both. I caught a glimpse of Marina slipping past, looking unusually unsettled.

I didn’t see Eliza until—well, until the shout rang out about her. I wish I’d spoken to her; there was tension between us, yes, about the manor, but this... 

I’m sorry. If I’d noticed anything truly amiss, I swear I’d have intervened.

🎬 VISUAL SCENE GENERATED!
  - Title: Scene: Testimony
  - Description: Julian West testified: (Adjusts cufflinks, a faint crease forming between his brows.)

Of course, De...
  - Image URL: https://v3.fal.media/files/tiger/Tlp37_VTD8bq_7I3-Yozs.png
  - Generated from: testimony
  - Character involved: Julian West
✅ Visual scene generated from question 5!

🔍 Testing visual question 6: 'What did you notice about the crime scene?'

🔍 Testing Question Character...
✅ Passed - Status: 200
Character name: Julian West
Response: (Leans back slightly, hands folded, voice steady but eyes betraying fatigue)

Detective, the scene struck me as...chaotic, which is not like Eliza. She prided herself on a meticulous workspace. The scattered books—especially that rare Audubon tome—suggest some sort of altercation, or at the very least, a desperate search. The wine glass was overturned, staining documents, and I noticed a distinct scent of her perfume, but overlaid with something sharper—perhaps brandy, though she wasn’t a brandy drinker.

The safe being ajar is troubling; it’s supposed to require a code known only to Eliza and, I believe, her assistant Clare. I didn’t see anyone else near the library when I arrived, though I did hear Roger Crane’s raised voice in the corridor earlier—he sounded agitated about a lost contract. I suppose stormy nights breed tempers. And, of course, there was that power flicker, which couldn’t have helped matters.

🎬 VISUAL SCENE GENERATED!
  - Title: Scene: Testimony
  - Description: Julian West testified: (Leans back slightly, hands folded, voice steady but eyes betraying fatigue)
...
  - Image URL: https://v3.fal.media/files/panda/BvQt0AC_g9SRJOq9VBtc7.png
  - Generated from: testimony
  - Character involved: Julian West
✅ Visual scene generated from question 6!

🔍 Testing visual question 7: 'Tell me what you remember seeing'

🔍 Testing Question Character...
✅ Passed - Status: 200
Character name: Julian West
Response: (Julian sits upright, hands clasped on his knee, voice even but tired.)

Yes, well—the evening was chaos with that storm howling through the windows. I’d just brought a bottle of Bordeaux up to my suite, preparing for a video conference with my Zurich partners around nine. The Wi-Fi flickered, then failed entirely—dreadful weather. During that time, I heard raised voices echoing from the hall. Sounded like Eliza and Roger—he’s never been subtle, particularly when the family’s money is the topic.

After the connection cut out, I tried ringing the front desk, but lines were down. I caught a glimpse of Tessa, the housekeeper, rushing up the stairs, oddly pale. The next I knew, someone was pounding at my door with news about Eliza.

I didn’t see Eliza at all after dinner, I’m afraid. If you need to confirm my alibi, my business partner in Zurich will vouch for most of that hour—at least until the signal died.

🔍 NEW CHARACTERS DISCOVERED: 1
  - Matthias Keller (A sharply-dressed man in his late 40s, Matthias is tall and lean, with swept-back salt-and-pepper hair and keen gray eyes behind designer spectacles. He speaks precise, lightly accented English and carries himself with a quiet, methodical confidence befitting an international financier. He is reserved but can be intense when discussing business.)
    Discovered through: Julian West
    Context: Julian's business partner in Zurich who can vouch for his alibi during the video conference until the signal died
✅ New character discovered! Switching to question this character...

🔍 Testing Get Final Case State...
✅ Passed - Status: 200

Final visual scenes count: 3
New visual scenes generated: 3

🔍 Testing Get Case Scenes...
✅ Passed - Status: 200
Retrieved 3 scenes from the gallery API

Scene 1:
  - Title: Scene: Testimony
  - Description: Julian West testified: (Leans back in the library chair, smoothing a silver cufflink, eyes troubled ...
  - Generated from: testimony
  - Character involved: Julian West

Scene 2:
  - Title: Scene: Testimony
  - Description: Julian West testified: (Adjusts cufflinks, a faint crease forming between his brows.)

Of course, De...
  - Generated from: testimony
  - Character involved: Julian West

Scene 3:
  - Title: Scene: Testimony
  - Description: Julian West testified: (Leans back slightly, hands folded, voice steady but eyes betraying fatigue)
...
  - Generated from: testimony
  - Character involved: Julian West
✅ VISUAL TESTIMONY SYSTEM TEST PASSED!
The investigation generated 3 visual scenes from testimony

==================================================
TESTING DYNAMIC CHARACTER DISCOVERY
==================================================

🔍 Testing Get Initial Case State...
✅ Passed - Status: 200
Initial character count: 7

🔍 Testing discovery question 1: 'Who else was around that evening?'

🔍 Testing Question Character...
✅ Passed - Status: 200
Character name: Matthias Keller
Response: (Adjusts glasses, voice calm but tinged with fatigue)

Detective, as I said, I was connecting remotely from Zurich, so my knowledge is unfortunately secondhand, gleaned from emails and the business call earlier in the evening. However, I know Julian West, Eliza’s partner, was present on the island—he and I were both on the videoconference. Marina Laurent, the gallery curator, had corresponded about cataloguing the Cassatt painting that afternoon. Roger Crane, Eliza’s legal advisor, was involved too, likely in the study.

Agnes—Eliza’s longtime housekeeper—typically oversees the staff and would have been managing the manor. Clare Davenport, Eliza’s friend and art restorer, was also expected. Tessa Yates, the young assistant, emailed me a schedule update that afternoon from the library. If anyone else arrived unexpectedly, I wouldn’t be privy; my involvement was strictly professional—and, regrettably, at a distance.

🔍 Testing discovery question 2: 'Did you see anyone acting suspicious?'

🔍 Testing Question Character...
✅ Passed - Status: 200
Character name: Matthias Keller
Response: [Matthias adjusts his glasses, folding his hands neatly.] I’m afraid I never set foot on Starling Isle, Detective—I remained in Zurich throughout the evening. My exposure to events is entirely remote. Nevertheless, I did notice a certain tension in Julian West’s demeanor during our videoconference with Eliza. He was curt, almost distracted, and kept glancing off-screen as if preoccupied with someone or something nearby. Eliza herself seemed unsettled as well—she cut our call short several times, claiming interruptions on her end from the staff.

I couldn’t say if it was anything sinister, but perhaps you might inquire with Roger Crane. He is head of estate security, yes? I imagine he would know if anyone was acting out of the ordinary, especially with the storm approaching.

I regret I cannot provide more, but if you need corroboration regarding my whereabouts, my assistant Ms. Brunner kept meticulous logs of the call.

🎬 VISUAL SCENE GENERATED!
  - Title: Scene: Testimony
  - Description: Matthias Keller testified: [Matthias adjusts his glasses, folding his hands neatly.] I’m afraid I ne...
  - Image URL: https://v3.fal.media/files/koala/DlBLI2uX_V5O0t9erAerC.png
  - Generated from: testimony
  - Character involved: Matthias Keller

🔍 Testing discovery question 3: 'Were there any staff members or visitors present?'

🔍 Testing Question Character...
✅ Passed - Status: 200
Character name: Matthias Keller
Response: Detective, I must clarify—I was never physically present on Starling Isle. My only involvement was via videoconference from Zurich. However, from my dealings with the company, I’m aware the estate is staffed year-round—there’s a housekeeper, Agnes Merriweather, who saw to guests and daily affairs, and Roger Crane, the caretaker, handles security and maintenance, if I recall correctly.

Aside from Eliza, Julian, and the occasional guest—Marina Laurent comes to mind, she’s one of Eliza’s recent clients—I can’t speak with certainty about who else was on the island that evening. My engagement was strictly professional. I do remember sensing some tension on the call earlier, which may be relevant. Perhaps Agnes or Roger would have better knowledge of the comings and goings that night. If you require contact details for any business associates, I can provide them.

🔍 Testing discovery question 4: 'Who else had access to the crime scene?'

🔍 Testing Question Character...
✅ Passed - Status: 200
Character name: Matthias Keller
Response: Detective, I regret I cannot provide direct observations—my only knowledge of the scene is what was visible during my videoconference. But I am aware that several individuals were staying at Starling Manor: Julian West, Eliza’s co-director; Marina Laurent, the art curator; Roger Crane, the security consultant; and those guests, Tessa Yates and Agnes Merriweather. Felicity Brunner, Eliza’s personal assistant, also had routine access to the library—she sometimes fetched files for Eliza, even during late hours. There is also Clare Davenport, the housekeeper, who tended to the room.

Given the library’s importance, anyone with business at the manor could plausibly pass through, especially on a stormy evening with staff stretched thin. I should also note, there were rumors of someone—a groundskeeper, perhaps—seen wandering the grounds during the blackout, but naturally I cannot verify this personally.

🔍 NEW CHARACTERS DISCOVERED: 1
  - Calvin 'Cal' Thatcher (A rugged, broad-shouldered man in his late 40s with wind-chapped skin, deep-set blue eyes, and calloused hands. Usually seen in a waxed canvas jacket and work boots, Cal speaks little but listens closely, projecting a stoic, weathered calm.)
    Discovered through: Matthias Keller
    Context: rumors of someone—a groundskeeper, perhaps—seen wandering the grounds during the blackout, but naturally I cannot verify this personally
✅ New character discovered! Switching to question this character...

🔍 Testing discovery question 5: 'Did anyone else know about the victim's activities?'

🔍 Testing Question Character...
✅ Passed - Status: 200
Character name: Calvin 'Cal' Thatcher
Response: (calms his breath, voice low and steady)

Couldn’t say for sure what Miss Harrow revealed to others, but she kept her business close. Far as I know, Julian West—the manager—was with her most afternoons, going over guest lists and contracts. Sometimes I’d see Marina, her assistant, bring in stacks of files, but she never lingered. Tessa Yates, the chef, tends to wander the manor most evenings; heard her mention some late-night menus Eliza wanted. 

Earlier today, I saw Roger Crane—friend of the family—in the library, arguing about the foundation’s funds. Seemed heated, but I kept to my work. Most folk give the old library a wide berth after dark. 

If you’re asking if anyone knew exactly what she was up to—maybe Julian or Marina. Folk like me? We’re kept in the dark, same as always.

🎬 VISUAL SCENE GENERATED!
  - Title: Scene: Testimony
  - Description: Calvin 'Cal' Thatcher testified: (calms his breath, voice low and steady)

Couldn’t say for sure wha...
  - Image URL: https://v3.fal.media/files/zebra/N2WNY4RQK-w1pi5H8HUMr.png
  - Generated from: testimony
  - Character involved: Calvin 'Cal' Thatcher

🔍 Testing Get Final Case State...
✅ Passed - Status: 200

Final character count: 9
New characters discovered: 2
✅ DYNAMIC CHARACTER DISCOVERY TEST PASSED!
The investigation started with 7 characters
and expanded to 9 characters through questioning.

🔍 Testing Get Case...
✅ Passed - Status: 200

🔍 Testing Analyze Evidence...
✅ Passed - Status: 200
Analysis response length: 4462
Analysis excerpt: # LOGICAL ANALYSIS: Murder on Starling Isle

## 1. STRENGTHS OF THIS THEORY

**Supporting Elements:**
- **Financial motive is statistically common** i...

==================================================
VISUAL TESTIMONY SYSTEM VERIFICATION:
1. Crime scene visualization is automatically generated for each case
2. Character testimony can trigger visual scene generation
3. Visual scenes are added to the case gallery
4. Visual scenes are linked to the character who described them
5. Visual triggers in testimony (e.g., 'I saw...', 'I witnessed...') generate scenes
==================================================

==================================================
📊 Tests passed: 22/22
==================================================
